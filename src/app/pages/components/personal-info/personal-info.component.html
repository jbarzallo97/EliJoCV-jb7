<div class="form-section">
  <h3 class="form-section-title">{{ 'form.personalInfo.title' | translate }}</h3>

  <form [formGroup]="form">
    <div class="row g-3">
      <!-- Nombre + Apellido (en mobile quedan seguidos) -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.firstName' | translate }} <span class="required-asterisk">*</span></label>
          <input
            type="text"
            class="form-control"
            formControlName="nombres"
            [placeholder]="'form.personalInfo.firstNamePh' | translate">
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.lastName' | translate }} <span class="required-asterisk">*</span></label>
          <input
            type="text"
            class="form-control"
            formControlName="apellidos"
            [placeholder]="'form.personalInfo.lastNamePh' | translate">
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.birthDate' | translate }}</label>
          <div class="input-group">
            <input
              type="date"
              class="form-control"
              formControlName="fechaNacimiento">
            <span class="input-group-text">
              <i class="material-icons">calendar_today</i>
            </span>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.jobTitle' | translate }}</label>
          <input
            type="text"
            class="form-control"
            formControlName="puesto"
            [placeholder]="'form.personalInfo.jobTitlePh' | translate">
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.age' | translate }}</label>
          <input
            type="text"
            class="form-control"
            [value]="age !== null ? (age + ' ' + ('cv.years' | translate)) : ''"
            [placeholder]="'common.dash' | translate"
            disabled>
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.phone' | translate }}</label>
          <input
            type="tel"
            class="form-control"
            formControlName="celular"
            [placeholder]="'form.personalInfo.phonePh' | translate">
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.email' | translate }} <span class="required-asterisk">*</span></label>
          <input
            type="email"
            class="form-control"
            formControlName="email"
            [placeholder]="'form.personalInfo.emailPh' | translate">
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.nationality' | translate }}</label>
          <input
            type="text"
            class="form-control"
            formControlName="nacionalidad"
            [placeholder]="'form.personalInfo.nationalityPh' | translate">
        </div>
      </div>

      <div class="col-12">
        <div class="mb-3">
          <label class="form-label">{{ 'form.personalInfo.address' | translate }}</label>
          <input
            type="text"
            class="form-control"
            formControlName="ubicacion"
            [placeholder]="'form.personalInfo.addressPh' | translate">
        </div>
      </div>
    </div>

    <!-- Resumen Profesional -->
    <div class="mb-3">
      <label class="form-label">{{ 'form.personalInfo.profile' | translate }}</label>
      <textarea
        class="form-control"
        formControlName="resumenProfesional"
        (keydown)="onResumenKeyDown($event)"
        (paste)="onResumenPaste($event)"
        rows="4"
        [placeholder]="'form.personalInfo.profilePh' | translate"></textarea>
      <div class="d-flex justify-content-between mt-1">
        <small class="text-muted">{{ 'form.personalInfo.profileMaxWords' | translate:{ max: resumenWordLimit } }}</small>
        <small class="text-muted" [class.text-danger]="resumenWordCount >= resumenWordLimit">
          {{ resumenWordCount }}/{{ resumenWordLimit }}
        </small>
      </div>
    </div>

    <!-- Foto de perfil -->
    <div class="mb-3">
      <label class="form-label mb-2">{{ 'form.personalInfo.photo' | translate }}</label>
      <div class="d-flex align-items-center gap-4 flex-wrap">
        <!-- Preview -->
        <div class="profile-photo-wrapper">
          <div class="profile-photo-circle">
            <ng-container *ngIf="photoPreview; else photoPlaceholder">
              <img [src]="photoPreview" [attr.alt]="'cv.photoAlt' | translate" class="profile-photo-img">
            </ng-container>
            <ng-template #photoPlaceholder>
              <div class="profile-photo-placeholder">
                <i class="material-icons mb-1">person</i>
                <small>{{ 'form.personalInfo.noPhoto' | translate }}</small>
              </div>
            </ng-template>
          </div>
          <button
            *ngIf="photoPreview"
            type="button"
            class="btn btn-danger btn-sm profile-photo-remove"
            (click)="removePhoto()"
            [title]="'form.personalInfo.removePhoto' | translate">
            <i class="material-icons" style="font-size: 18px;">close</i>
          </button>
        </div>

        <!-- Actions -->
        <div class="d-flex flex-column gap-2">
          <input
            type="file"
            id="photoUpload"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="d-none">
          <label
            for="photoUpload"
            class="btn btn-outline-primary d-inline-flex align-items-center gap-2 mb-0">
            <i class="material-icons" style="font-size: 20px;">add_a_photo</i>
            <span>{{ (photoPreview ? 'form.personalInfo.changePhoto' : 'form.personalInfo.addPhoto') | translate }}</span>
          </label>
          <small class="text-muted">{{ 'form.personalInfo.photoHint' | translate }}</small>
        </div>
      </div>
    </div>
  </form>
</div>

